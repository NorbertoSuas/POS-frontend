<app-generic-modal 
  [isOpen]="isOpen()" 
  title="Edit Audit Log"
  (closed)="onClose()">
  
  <!-- Current log information -->
  <div class="current-log-info">
    <div class="info-badge">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span>{{ currentLogInfo() }}</span>
    </div>
  </div>
  
  <form [formGroup]="editForm" (ngSubmit)="onSubmit()" class="space-y-4">
    <!-- User ID -->
    <div class="form-group">
      <label for="editUserId" class="form-label">
        User ID <span class="text-red-500">*</span>
      </label>
      <input 
        type="number" 
        id="editUserId" 
        formControlName="userId"
        class="form-input"
        [class.error]="isFieldInvalid('userId')"
        placeholder="Enter user ID">
      @if (isFieldInvalid('userId')) {
        <span class="error-message">{{ getFieldError('userId') }}</span>
      }
    </div>

    <!-- Action -->
    <div class="form-group">
      <label for="editAction" class="form-label">
        Action <span class="text-red-500">*</span>
      </label>
      <select 
        id="editAction" 
        formControlName="action"
        class="form-select"
        [class.error]="isFieldInvalid('action')">
        <option value="">Select an action</option>
        @for (action of actionOptions; track action) {
          <option [value]="action">{{ action }}</option>
        }
      </select>
      @if (isFieldInvalid('action')) {
        <span class="error-message">{{ getFieldError('action') }}</span>
      }
    </div>

    <!-- Entity Type -->
    <div class="form-group">
      <label for="editEntityType" class="form-label">
        Entity Type <span class="text-red-500">*</span>
      </label>
      <select 
        id="editEntityType" 
        formControlName="entityType"
        class="form-select"
        [class.error]="isFieldInvalid('entityType')">
        <option value="">Select entity type</option>
        @for (entityType of entityTypeOptions; track entityType) {
          <option [value]="entityType">{{ entityType }}</option>
        }
      </select>
      @if (isFieldInvalid('entityType')) {
        <span class="error-message">{{ getFieldError('entityType') }}</span>
      }
    </div>

    <!-- Entity ID -->
    <div class="form-group">
      <label for="editEntityId" class="form-label">
        Entity ID <span class="text-red-500">*</span>
      </label>
      <input 
        type="number" 
        id="editEntityId" 
        formControlName="entityId"
        class="form-input"
        [class.error]="isFieldInvalid('entityId')"
        placeholder="Enter entity ID">
      @if (isFieldInvalid('entityId')) {
        <span class="error-message">{{ getFieldError('entityId') }}</span>
      }
    </div>

    <!-- Previous Values -->
    <div class="form-group">
              <label for="editOldValues" class="form-label">Previous Values</label>
      <textarea 
        id="editOldValues" 
        formControlName="oldValues"
        class="form-textarea"
        rows="3"
        placeholder="Previous values (optional)"></textarea>
    </div>

    <!-- New Values -->
    <div class="form-group">
              <label for="editNewValues" class="form-label">New Values</label>
      <textarea 
        id="editNewValues" 
        formControlName="newValues"
        class="form-textarea"
        rows="3"
        placeholder="New values (optional)"></textarea>
    </div>

    <!-- User Agent -->
    <div class="form-group">
      <label for="editUserAgent" class="form-label">User Agent</label>
      <input 
        type="text" 
        id="editUserAgent" 
        formControlName="userAgent"
        class="form-input"
        placeholder="User browser (optional)">
    </div>

    <!-- Action buttons -->
    <div class="form-actions">
      <button 
        type="button" 
        class="btn btn-secondary"
        (click)="onClose()"
        [disabled]="loading()">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
        Cancel
      </button>
      
      <button 
        type="submit" 
        class="btn btn-primary"
        [disabled]="editForm.invalid || loading()">
        @if (loading()) {
          <span class="loading-spinner"></span>
          Updating...
        } @else {
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
          </svg>
          Update Log
        }
      </button>
    </div>
  </form>
</app-generic-modal>
